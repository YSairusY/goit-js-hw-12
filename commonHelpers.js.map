{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nexport let perPage = 15;\nimport { page } from '../main';\n\nexport async function getPictures(query, currentPage) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const params = new URLSearchParams({\n    key: '45645042-c9b2fc3a6d24b970e9e620bb9',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: perPage,\n  });\n  const url = `${BASE_URL}?${params}`;\n\n  const images = await axios\n    .get(url)\n    .then(response => response.data.hits)\n    .catch(error => console.log(error));\n\n  return images;\n}","export function renderElement({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width=\"360\"\n            />\n          </a>\n          <div class=\"thumb-block\">\n            <div class=\"block\">\n              <h2 class=\"tittle\">Likes</h2>\n              <p class=\"amount\">${likes}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"tittle\">Views</h2>\n              <p class=\"amount\">${views}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"tittle\">Comments</h2>\n              <p class=\"amount\">${comments}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"tittle\">Downloads</h2>\n              <p class=\"amount\">${downloads}</p>\n            </div>\n          </div>\n        </li>`;\n}\n\nexport function renderElements(arr) {\n  return arr.map(renderElement).join('');\n}","import { getPictures } from './js/pixabay-api.js';\nimport { renderElement } from './js/render-functions.js';\nimport { renderElements } from './js/render-functions.js';\nimport { perPage } from './js/pixabay-api.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport css from './css/styles.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-btn');\n\nexport let page = 1;\nlet inputValue = '';\nlet totalHits = 0;\nlet totalLoaded = 0;\n\nhideLoadBtn();\n\nform.addEventListener('submit', handleSubmit);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  inputValue = event.currentTarget.elements.input.value.trim();\n  gallery.innerHTML = '';\n\n  if (!inputValue) {\n    iziToast.warning({\n      title: 'Caution',\n      message: 'You forgot to fill in the form!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  page = 1;\n  totalLoaded = 0;\n  gallery.innerHTML = '';\n  hideLoadBtn();\n\n  showLoader();\n  try {\n    const { hits: images, totalHits: total } = await getPictures(inputValue, page);\n    totalHits = total;\n    totalLoaded = images.length;\n    hideLoader();\n\n    if (images === undefined || images.length === 0) {\n      iziToast.error({\n        title: 'Search result',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    const markup = renderElements(images);\n    gallery.innerHTML = markup;\n\n    initializeSlider();\n\n    if (totalLoaded >= totalHits) {\n      iziToast.warning({\n        title: 'End of Results',\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n      hideLoadBtn();\n    } else {\n      showLoadBtn();\n    }\n  } catch (error) {\n    hideLoader();\n    handleError(error);\n  }\n\n  form.reset();\n}\n\nloadBtn.addEventListener('click', handleMore);\n\nasync function handleMore(event) {\n  page += 1;\n  loadBtn.style.display = 'none';\n  showLoader();\n\n  try {\n    const { hits: newImages } = await getPictures(inputValue, page);\n    totalLoaded += newImages.length;\n    const markup = renderElements(newImages);\n    gallery.insertAdjacentHTML('beforeend', markup);\n\n    initializeSlider();\n    myScroll();\n    hideLoader();\n\n    if (totalLoaded >= totalHits) {\n      iziToast.warning({\n        title: 'End of Results',\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n      hideLoadBtn();\n    } else {\n      showLoadBtn();\n    }\n    \n  } catch (error) {\n    hideLoader();\n    handleError(error);\n  }\n}\n\nfunction showLoader() {\n  let existingLoader = document.querySelector('.loader');\n  if (!existingLoader) {\n    const loader = document.createElement('div');\n    loader.className = 'loader';\n    form.insertAdjacentElement('afterend', loader);\n  }\n}\n\nfunction hideLoader() {\n  const loader = document.querySelector('.loader');\n  if (loader) {\n    loader.remove();\n  }\n}\n\nfunction hideLoadBtn() {\n  loadBtn.style.display = 'none';\n}\n\nfunction showLoadBtn() {\n  loadBtn.style.display = 'flex';\n}\n\nfunction myScroll() {\n  const card = document.querySelector('.gallery-item');\n  const cardParams = card.getBoundingClientRect().height;\n  window.scrollBy({\n    top: cardParams * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction initializeSlider() {\n  let gallerySlider = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n    captionsData: 'alt',\n  }).refresh();\n}\n\nfunction handleError(error) {\n  if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {\n    iziToast.error({\n      title: 'Network Error',\n      message: 'Unable to connect. Please check your internet connection and try again.',\n      position: 'topRight',\n    });\n  } else {\n    iziToast.error({\n      title: 'Error',\n      message: `Error: ${error.message}`,\n      position: 'topRight',\n    });\n  }\n}\n"],"names":["perPage","getPictures","query","currentPage","BASE_URL","params","url","axios","response","error","renderElement","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderElements","arr","form","gallery","loadBtn","page","inputValue","totalHits","totalLoaded","hideLoadBtn","handleSubmit","event","iziToast","showLoader","images","total","hideLoader","markup","initializeSlider","showLoadBtn","handleError","handleMore","newImages","myScroll","loader","cardParams","SimpleLightbox"],"mappings":"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"}